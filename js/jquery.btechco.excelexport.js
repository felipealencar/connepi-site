!function(t){$datatype={Table:1,Json:2,Xml:3,JqGrid:4};var e={containerid:null,datatype:$datatype.Table,dataset:null,columns:null,filename:null},i=e;t.fn.btechco_excelexport=function(d){function h(){var e="<table>";return e+="<thead><tr>",t(i.columns).each(function(t,i){1!=this.ishidden&&(e+="<th",null!=this.width&&(e+=" style='width: "+this.width+"'"),e+=">",e+=this.headertext,e+="</th>")}),e+="</tr></thead>",e+="<tbody>",t(i.dataset).each(function(d,h){e+="<tr>",t(i.columns).each(function(t,i){h.hasOwnProperty(this.datafield)&&1!=this.ishidden&&(e+="<td",null!=this.width&&(e+=" style='width: "+this.width+"'"),e+=">",e+=h[this.datafield],e+="</td>")}),e+="</tr>"}),e+="</tbody>",e+="</table>"}function a(){var e="<table>";return e+="<thead><tr>",t(i.columns).each(function(t,i){1!=this.ishidden&&(e+="<th",null!=this.width&&(e+=" style='width: "+this.width+"'"),e+=">",e+=this.headertext,e+="</th>")}),e+="</tr></thead>",e+="<tbody>",t(i.dataset).find("row").each(function(d,h){e+="<tr>",t(i.columns).each(function(i,d){t(h).attr(this.datafield)&&1!=this.ishidden&&(e+="<td",null!=this.width&&(e+=" style='width: "+this.width+"'"),e+=">",e+=t(h).attr(this.datafield),e+="</td>")}),e+="</tr>"}),e+="</tbody>",e+="</table>"}function n(){var e="<table>";return e+="<thead><tr>",t(i.columns).each(function(t,i){1!=this.ishidden&&(e+="<th",null!=this.width&&(e+=" style='width: "+this.width+"'"),e+=">",e+=this.headertext,e+="</th>")}),e+="</tr></thead>",e+="<tbody>",t(i.dataset).find("rows > row").each(function(d,h){e+="<tr>",t(i.columns).each(function(i,d){t(h).find(this.datafield)&&1!=this.ishidden&&(e+="<td",null!=this.width&&(e+=" style='width: "+this.width+"'"),e+=">",e+=t(h).find(this.datafield).text(),e+="</td>")}),e+="</tr>"}),e+="</tbody>",e+="</table>"}function s(e){var d="<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:x='urn:schemas-microsoft-com:office:excel' xmlns='http://www.w3.org/TR/REC-html40'>";d+="<head>",d+="<!--[if gte mso 9]>",d+="<xml>",d+="<x:ExcelWorkbook>",d+="<x:ExcelWorksheets>",d+="<x:ExcelWorksheet>",d+="<x:Name>",d+="{worksheet}",d+="</x:Name>",d+="<x:WorksheetOptions>",d+="<x:DisplayGridlines/>",d+="</x:WorksheetOptions>",d+="</x:ExcelWorksheet>",d+="</x:ExcelWorksheets>",d+="</x:ExcelWorkbook>",d+="</xml>",d+="<![endif]-->",d+="</head>",d+="<body>",d+=e.replace(/"/g,"'"),d+="</body>",d+="</html>";var h="base64,"+t.base64.encode(d),a=null==i.filename?"test":i.filename,n="data:application/vnd.ms-excel;"+h,s=document.createElement("a");s.href=n,s.download=a+".xls",document.body.appendChild(s),s.click(),document.body.removeChild(s)}switch(i=t.extend({},e,d),i.datatype){case 1:s(t("#"+i.containerid).parent().html());break;case 2:s(h());break;case 3:s(a());break;case 4:s(n())}}}(jQuery);
